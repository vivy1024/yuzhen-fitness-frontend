# 系统架构总览

**版本**: v1.1.0  
**更新日期**: 2026-01-06  
**状态**: ✅ 已完成

---

## 📋 项目概述

玉珍健身前端是一个基于Vue 3的现代化PWA应用，提供AI驱动的智能健身指导服务。

### 核心特性

- ✅ **AI聊天**: 流式响应、话题管理、工具调用可视化
- ✅ **训练计划**: 智能生成、一键导入、进度追踪
- ✅ **PWA支持**: 离线缓存、安装提示、推送通知
- ✅ **响应式设计**: 移动优先、自适应布局
- ✅ **类型安全**: 全面TypeScript支持

---

## 🏗️ 分层架构

### 1. 视图层 (Views)

**职责**: 页面级组件，负责页面布局和路由

**目录**: `src/views/`

**示例**:
```
views/
├── ai/
│   └── chat.vue          # AI聊天页面
├── training/
│   ├── plans.vue         # 训练计划列表
│   └── detail.vue        # 训练计划详情
├── auth/
│   ├── login.vue         # 登录页面
│   └── register.vue      # 注册页面
└── profile/
    └── index.vue         # 个人中心
```

### 2. 组件层 (Components)

**职责**: 可复用的UI组件

**目录**: `src/components/`

**分类**:
- **ui/**: shadcn-vue基础组件
- **chat/**: 聊天相关组件
- **training/**: 训练相关组件
- **common/**: 通用业务组件

### 3. 状态管理层 (Stores)

**职责**: 全局状态管理

**目录**: `src/stores/`

**技术**: Pinia

**Store模块**:
- **chat**: 聊天消息管理
- **topic**: 话题管理
- **streaming**: 流式响应状态
- **auth**: 用户认证
- **training**: 训练计划

### 4. API层

**职责**: HTTP请求封装

**目录**: `src/api/`

**技术**: Axios

### 5. 工具层 (Utils)

**职责**: 工具函数、常量、类型定义

**目录**: `src/utils/`, `src/types/`

---

## 🔄 数据流

### 单向数据流

```
用户操作 → Action → API请求 → 更新State → 视图更新
```

### 流式响应数据流

```
用户发送消息 → Chat Store → useChatStream → SSE Worker → 实时更新 → IndexedDB缓存
```

---

## 🎨 UI架构

### 设计系统

**基础**: shadcn-vue + Tailwind CSS

**响应式断点**:
- sm: 640px (手机横屏)
- md: 768px (平板)
- lg: 1024px (笔记本)
- xl: 1280px (桌面)

---

## 🔌 集成架构

### 后端集成

**Laravel API** (端口8000):
- 用户认证、话题管理、训练计划、数据持久化

**DAML-RAG API** (端口8001):
- AI聊天、流式响应、工具调用、训练计划生成

---

## 🔄 v1.1.0 更新 (2026-01-06)

### 用户档案系统增强

- 新增 `postural_issues` 字段支持12种体态问题
- 器械选项与Neo4j Equipment节点完全对应（21个）
- 伤病选项与Neo4j InjuryType节点完全对应（21个）
- 训练目标与Neo4j TrainingGoal节点完全对应（8个）

---

**维护者**: 薛小川  
**最后更新**: 2026-01-06
